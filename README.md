# 연구비 예산관리 시스템

외부 ERP 파일 없이, 프로그램 화면에서 연구비 지출내역을 직접 입력·수정하고, 저장된 엑셀 파일을 다시 읽어와 예산 집계·관리를 반복 수행할 수 있는 경량 연구비 예산관리 도구입니다.

## 주요 기능

- ✅ **지출내역 관리**: 프로그램 화면에서 직접 지출내역 입력/수정/삭제
- ✅ **ERP 기준 집계**: ERP 통계목별 예산 집계 및 집행률 계산
- ✅ **RCMS 기준 집계**: RCMS 세부항목별 예산 집계 및 미정산 금액 계산
- ✅ **예산 관리**: ERP/RCMS 예산 직접 입력 및 수정
- ✅ **엑셀 기반 저장**: 모든 데이터를 master.xlsx 파일로 저장
- ✅ **다중 과제 관리**: 각 과제별로 독립적인 파일 관리

## 설치 및 실행

### 방법 1: 포터블 버전 (Python 설치 불필요) - 권장

1. **Python Portable 다운로드**
   - https://www.python.org/downloads/windows/
   - "Windows embeddable package" 다운로드 (Python 3.11 이상)
   - 예: `python-3.11.9-embed-amd64.zip`

2. **압축 해제 및 배치**
   - 다운로드한 zip 파일을 압축 해제
   - 압축 해제한 폴더를 프로젝트 폴더 안에 `python` 폴더로 이름 변경
   ```
   연구비관리시스템/
   ├── python/          ← Python Portable 폴더
   ├── app.py
   ├── ... (모든 파일)
   └── 실행.bat
   ```

3. **실행**
   - `실행.bat` 파일을 더블클릭
   - 처음 실행 시 패키지가 자동으로 설치됩니다

### 방법 2: 일반 버전 (Python 설치 필요)

1. **Python 설치**
   - Python 3.10 이상 설치 필요
   - https://www.python.org/downloads/
   - 설치 시 "Add Python to PATH" 체크

2. **실행**
   - `실행.bat` 파일을 더블클릭
   - 처음 실행 시 패키지가 자동으로 설치됩니다

## 사용 방법

### 첫 실행

1. 프로그램을 실행하면 **작업 파일 선택** 화면이 표시됩니다.
2. 다음 중 하나를 선택합니다:
   - **기존 파일 열기**: 이미 있는 master.xlsx 파일을 선택
   - **폴더 선택**: 작업 폴더를 선택하면 해당 폴더의 master.xlsx를 사용 (없으면 자동 생성)

### 지출내역 입력

1. **지출내역 관리** 메뉴로 이동
2. 표에서 직접 데이터를 입력/수정할 수 있습니다
3. **💾 반영저장** 버튼을 클릭하여 저장

### 예산 설정

1. **집행 결과** 메뉴로 이동
2. ERP 예산 또는 RCMS 예산에서 예산 금액을 직접 수정
3. 자동으로 집계가 실행됩니다

## 파일 구조

```
프로젝트 폴더/
├── app.py                  # 메인 애플리케이션
├── config.py               # 설정 관리
├── data_manager.py         # 데이터 로드/저장
├── expense_manager.py       # 지출내역 관리
├── budget_calculator.py     # 예산 집계 계산
├── initial_data.py          # 초기 데이터
├── ui_components.py         # UI 컴포넌트
├── validators.py            # 데이터 검증
├── utils.py                 # 유틸리티
├── folder_dialog.py         # 폴더 선택
├── requirements.txt         # 패키지 의존성
├── 실행.bat                 # 실행 스크립트
└── README.md                # 사용 설명서
```

### master.xlsx 시트 구성

- **EXPENSE**: 지출내역 데이터
- **ERP_BUDGET**: ERP 기준 예산 및 집계 결과
- **RCMS_BUDGET**: RCMS 기준 예산 및 집계 결과
- **MAPPING_ERP_RCMS**: ERP-RCMS 매핑 정보

## 배포 방법

### 공유 폴더 배포

1. **필요한 파일 복사**
   - 모든 `.py` 파일
   - `requirements.txt`
   - `실행.bat`
   - `README.md`
   - (선택) `python` 폴더 (포터블 버전인 경우)

2. **공유 폴더에 업로드**

3. **사용자 안내**
   ```
   공유 폴더에서 프로그램을 다운로드하고,
   '실행.bat' 파일을 더블클릭하세요.
   처음 실행 시 패키지가 자동으로 설치됩니다.
   ```

## 주요 특징

### ERP 통계목 (14개)
총액, 기타직보수, 상용임금, 일반수용비, 임차료, 유류비, 재료비, 국내여비, 국외업무여비, 사업추진비, 자산취득비, 무형자산, 일반관리비, 고용부담금

### RCMS 세부항목 (23개)
인건비 (2개), 연구시설장비비 (4개), 연구재료비 (3개), 연구활동비 (12개), 연구수당 (1개), 간접비 (1개)

## 문제 해결

### Python이 설치되어 있지 않습니다
- Python 3.10 이상을 설치하거나
- 포터블 버전을 사용하세요 (Python Portable을 `python` 폴더에 설치)

### 패키지 설치 실패
- 인터넷 연결 확인
- 관리자 권한으로 실행
- `python -m pip install --upgrade pip` 실행 후 재시도

### 프로그램이 실행되지 않음
- `실행.bat`를 관리자 권한으로 실행
- 방화벽 경고가 나오면 "허용" 선택

## 라이선스

이 프로젝트는 개인 사용 목적으로 개발되었습니다.
