# 연구비 예산관리 시스템

외부 ERP 파일 없이, 프로그램 화면에서 연구비 지출내역을 직접 입력·수정하고, 저장된 엑셀 파일을 다시 읽어와 예산 집계·관리를 반복 수행할 수 있는 경량 연구비 예산관리 도구입니다.

## 주요 기능

- ✅ **지출내역 관리**: 프로그램 화면에서 직접 지출내역 입력/수정/삭제
- ✅ **ERP 기준 집계**: ERP 통계목별 예산 집계 및 집행률 계산
- ✅ **RCMS 기준 집계**: RCMS 세부항목별 예산 집계 및 미정산 금액 계산
- ✅ **예산 관리**: ERP/RCMS 예산 직접 입력 및 수정
- ✅ **엑셀 기반 저장**: 모든 데이터를 master.xlsx 파일로 저장
- ✅ **다중 과제 관리**: 각 과제별로 독립적인 파일 관리

## 설치 방법

### 1. Python 설치
Python 3.10 이상이 필요합니다.

### 2. 패키지 설치

#### 일반 Python 환경
```bash
pip install -r requirements.txt
```

#### Anaconda 환경
```bash
conda install streamlit pandas openpyxl plotly
# 또는
pip install -r requirements.txt
```

### 3. 프로그램 실행

#### 일반 Python 환경
```bash
streamlit run app.py
# 또는
python -m streamlit run app.py
```

#### Anaconda 환경
1. **Anaconda Prompt**를 실행합니다
2. 프로젝트 폴더로 이동:
   ```bash
   cd C:\Users\geuns\PythonCode\rnd_monitor
   ```
3. 프로그램 실행:
   ```bash
   streamlit run app.py
   ```

브라우저가 자동으로 열리며 프로그램이 실행됩니다.

## 사용 방법

### 첫 실행

1. 프로그램을 실행하면 **작업 파일 선택** 화면이 표시됩니다.
2. 다음 중 하나를 선택합니다:
   - **기존 파일 열기**: 이미 있는 master.xlsx 파일을 선택
   - **폴더 선택**: 작업 폴더를 선택하면 해당 폴더의 master.xlsx를 사용 (없으면 생성)
   - **새 프로젝트**: 새 폴더를 선택하고 master.xlsx를 생성

### 지출내역 입력

1. **지출내역 관리** 메뉴로 이동
2. **새 행 추가** 버튼 클릭
3. 필수 정보 입력:
   - 통계목명 (필수)
   - 사용일자 (필수)
   - 지출결의명 (필수)
   - 지출결의액 (필수)
   - 상세내역 (선택)
   - RCMS 항목 (선택)
4. **추가** 버튼 클릭
5. **저장** 버튼으로 데이터 저장

### 예산 설정

#### ERP 예산 설정
1. **ERP 예산** 메뉴로 이동
2. **예산 수정** 버튼 클릭
3. 각 통계목별로 실행예산 입력
4. **저장** 버튼 클릭

#### RCMS 예산 설정
1. **RCMS 예산** 메뉴로 이동
2. **예산 수정** 버튼 클릭
3. 각 RCMS 세부항목별로 예산 입력
4. **저장** 버튼 클릭

### 예산 집계

1. **ERP 예산** 또는 **RCMS 예산** 메뉴로 이동
2. **집계 실행** 버튼 클릭
3. 집행액, 잔액, 집행률이 자동으로 계산됩니다.

## 파일 구조

```
프로젝트 폴더/
├── master.xlsx              # 핵심 데이터 파일
├── master_backup_*.xlsx     # 자동 백업 파일들
└── export/                  # 보고용 출력 파일 (선택)
```

### master.xlsx 시트 구성

- **EXPENSE**: 지출내역 데이터
- **ERP_BUDGET**: ERP 기준 예산 및 집계 결과
- **RCMS_BUDGET**: RCMS 기준 예산 및 집계 결과
- **MAPPING_ERP_RCMS**: ERP-RCMS 매핑 정보

## 프로젝트 구조

```
rnd_monitor/
├── app.py                  # Streamlit 메인 애플리케이션
├── config.py               # 설정 관리 모듈
├── data_manager.py         # 데이터 로드/저장 관리
├── expense_manager.py      # 지출내역 관리 로직
├── budget_calculator.py    # 예산 집계 계산 로직
├── initial_data.py         # 초기 데이터 생성 모듈
├── ui_components.py         # 재사용 가능한 UI 컴포넌트
├── validators.py           # 데이터 검증 로직
├── utils.py                # 유틸리티 함수
├── requirements.txt        # 패키지 의존성
└── README.md               # 사용자 가이드
```

## 주요 특징

### ERP 통계목 (14개)
- 총액, 기타직보수, 상용임금, 일반수용비, 임차료, 유류비, 재료비, 국내여비, 국외업무여비, 사업추진비, 자산취득비, 무형자산, 일반관리비, 고용부담금

### RCMS 세부항목 (23개)
- 인건비 (2개), 연구시설장비비 (4개), 연구재료비 (3개), 연구활동비 (12개), 연구수당 (1개), 간접비 (1개)

## 문제 해결

### 파일이 열리지 않을 때
- 파일 경로에 한글이 포함되어 있는지 확인
- 파일이 다른 프로그램에서 열려있는지 확인
- 파일 권한을 확인

### 데이터가 저장되지 않을 때
- 파일 쓰기 권한 확인
- 디스크 공간 확인
- 백업 파일이 생성되는지 확인

## 배포

### Streamlit Cloud 배포

이 프로젝트를 Streamlit Cloud에 배포하여 웹에서 사용할 수 있습니다.

**배포 가이드**: [DEPLOYMENT.md](DEPLOYMENT.md) 파일을 참조하세요.

**주요 단계**:
1. GitHub에 저장소 생성 및 코드 업로드
2. Streamlit Cloud (https://share.streamlit.io)에서 앱 배포
3. 자동 배포 완료

**주의사항**:
- Streamlit Cloud에서는 로컬 폴더 선택 다이얼로그가 작동하지 않습니다
- 파일 업로드 기능을 사용하여 데이터를 관리하세요
- 세션 종료 시 데이터가 초기화될 수 있으므로, 중요한 데이터는 다운로드하여 보관하세요

## 라이선스

이 프로젝트는 개인 사용 목적으로 개발되었습니다.

## 문의

문제가 발생하거나 개선 사항이 있으면 이슈를 등록해주세요.

